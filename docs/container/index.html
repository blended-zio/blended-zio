<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blended-zio/blog/rss.xml" title="Blended ZIO Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blended-zio/blog/atom.xml" title="Blended ZIO Blog Atom Feed"><title data-react-helmet="true">Service based containers | Blended ZIO</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Service based containers | Blended ZIO"><meta data-react-helmet="true" name="description" content="A JVM executing a blended application will be referenced to as a blended container. When blended was started in it&#x27;s first version, it has been a Java application running inside a J2EE server, which everyone referred to as a container. Over time blended has evolved to a stand-alone Scala application on top of OSGi, but the term container has stuck."><meta data-react-helmet="true" property="og:description" content="A JVM executing a blended application will be referenced to as a blended container. When blended was started in it&#x27;s first version, it has been a Java application running inside a J2EE server, which everyone referred to as a container. Over time blended has evolved to a stand-alone Scala application on top of OSGi, but the term container has stuck."><meta data-react-helmet="true" property="og:url" content="https://blended-zio.github.io/blended-zio/blended-zio/docs/container"><link data-react-helmet="true" rel="shortcut icon" href="/blended-zio/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://blended-zio.github.io/blended-zio/blended-zio/docs/container"><link rel="stylesheet" href="/blended-zio/styles.b0c1b4e5.css">
<link rel="preload" href="/blended-zio/styles.da6d526b.js" as="script">
<link rel="preload" href="/blended-zio/runtime~main.bbb75a21.js" as="script">
<link rel="preload" href="/blended-zio/main.2b8b45e6.js" as="script">
<link rel="preload" href="/blended-zio/1.9a06b93b.js" as="script">
<link rel="preload" href="/blended-zio/2.a102c19c.js" as="script">
<link rel="preload" href="/blended-zio/54.dd637c66.js" as="script">
<link rel="preload" href="/blended-zio/55.9221783b.js" as="script">
<link rel="preload" href="/blended-zio/935f2afb.ed868d14.js" as="script">
<link rel="preload" href="/blended-zio/17896441.58f5d11b.js" as="script">
<link rel="preload" href="/blended-zio/3509527d.8a506882.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/blended-zio/"><img src="/blended-zio/img/Logos/svg/black_no_background.svg" alt="Blended ZIO" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/blended-zio/img/Logos/svg/black_no_background.svg" alt="Blended ZIO" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blended-zio/docs/">Docs</a><a class="navbar__item navbar__link" href="/blended-zio/blog">Blog</a><a href="https://github.com/blended-zio/blended-zio" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/blended-zio/"><img src="/blended-zio/img/Logos/svg/black_no_background.svg" alt="Blended ZIO" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/blended-zio/img/Logos/svg/black_no_background.svg" alt="Blended ZIO" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blended-zio/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blended-zio/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/blended-zio/blended-zio" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Overview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blended-zio/docs/">Blended Use Cases</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/blended-zio/docs/container">Service based containers</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Modules</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blended-zio/docs/core/index">Blended ZIO Core</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">JMX</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blended-zio/docs/jmx/index">JMX Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blended-zio/docs/jmx/mbeanserver">A simple MBean Server Facade</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blended-zio/docs/jmx/mbeanpublisher">MBean Publisher</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blended-zio/docs/jmx/servicemetrics">Service Metrics</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blended-zio/docs/streams/index">Blended ZIO Streams</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Service based containers</h1></header><div class="markdown"><p>A JVM executing a blended application will be referenced to as a <em>blended container</em>. When <em>blended</em> was started in it&#x27;s first version, it has been a Java application running inside a J2EE server, which everyone referred to as a container. Over time <em>blended</em> has evolved to a stand-alone Scala application on top of OSGi, but the term <em>container</em> has stuck.</p><p>A typical <em>blended environment</em> consists of several <em>blended containers</em> distributed across geographical regions throughout the enterprise and the core use case for a <em>blended environment</em> is to provide a communication backbone across the enterprise for other applications. As such <em>blended</em> is the layer to realize enterprise level deployment policies such as enforcing security, connection management and general message routing.</p><p>To achieve this, <em>blended</em> makes use of other enterprise applications such as messaging backbones, the PKI infrastructure and others. Every access to an external application is realized within a module and exposed to other modules only in terms of service interfaces, so that a change in the implementation has only minimal impact. In essence, one could say that blended consists of layered services running within the same JVM.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>For example, within <em>Blended 3</em> the JMS connectivity is realized as a service which is offered to other modules with the <code>ConnectionFactory</code> interface defined in the <a href="https://download.oracle.com/otndocs/jcp/7195-jms-1.1-fr-spec-oth-JSpec/" target="_blank" rel="noopener noreferrer">JMS specification</a>. Under the covers the implementation uses a keep alive mechanism to ensure that JMS connections are alive and operational.</p><p>Another example is a <code>CertificateManager</code> managing the key- and trust-store of a <em>blended container</em>. Within <em>Blended 3</em>, an implementation with self signed certificates and another based on the <a href="https://en.wikipedia.org/wiki/Simple_Certificate_Enrollment_Protocol" target="_blank" rel="noopener noreferrer"><code>SCEP</code> protocol</a> to provision certificates exist. These certificates are used by the <code>SSLContext</code> service, which is in turn used by all modules that need to offer a SSL based server socket.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="container-types"></a>Container types<a class="hash-link" href="#container-types" title="Direct link to heading">#</a></h2><p>Within a blended environment several <strong>container types</strong> might exist. Each container type is defined by the services that are configured for that particular container. As a general rule, two containers of the same type differ from each other <strong>only</strong> within their configuration.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="container-deployment"></a>Container deployment<a class="hash-link" href="#container-deployment" title="Direct link to heading">#</a></h2><p>A container deployment consists of the jar files with the services and their implementations and the configuration files.</p><p>Within <em>Blended 3</em> it has proven to be a best practice that the configuration files should be kept identical across all container types within a blended environment. To achieve that, the configuration files should allow to define placeholders that can be filled in at runtime. All differences between two containers of the same type are exclusively realized by having different values within the environment variables referenced in the config files.</p><p>For example, the configuration for a LDAP service might look like:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">  url             </span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;ldaps://ldap.$[[env]].$[[country]]:4712&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">  systemUser</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;     : &quot;</span><span class="token plain">admin&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  systemPassword</span><span class="token string" style="color:rgb(72, 118, 214)">&quot; : &quot;</span><span class="token plain">$</span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">(encrypted)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token number" style="color:rgb(170, 9, 130)">5</span><span class="token plain">c</span><span class="token number" style="color:rgb(170, 9, 130)">4e48</span><span class="token plain">e</span><span class="token number" style="color:rgb(170, 9, 130)">1920836</span><span class="token plain">f</span><span class="token number" style="color:rgb(170, 9, 130)">68</span><span class="token plain">f</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain">abbaf</span><span class="token number" style="color:rgb(170, 9, 130)">60e9</span><span class="token plain">b</span><span class="token number" style="color:rgb(170, 9, 130)">026</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain">&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  userBase</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;       : &quot;</span><span class="token plain">o=employee&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  userAttribute</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;  : &quot;</span><span class="token plain">uid&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  groupBase</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;      : &quot;</span><span class="token plain">ou=sib</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">ou=apps</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">o=global&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  groupAttribute</span><span class="token string" style="color:rgb(72, 118, 214)">&quot; : &quot;</span><span class="token plain">cn&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  groupSearch</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;    : &quot;</span><span class="token plain">(member=</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain">)&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In this example, two environment variables - <code>env</code> and <code>country</code> - are required to resolve the LDAP url. In terms of service we need</p><ul><li>a crypto service to decrypt encrypted config values</li><li>an evaluation service to resolve config expressions that might occur in config files</li></ul><p>These services can than be used by <strong>all</strong> modules that need to be configured.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="container-directory-structure"></a>Container directory structure<a class="hash-link" href="#container-directory-structure" title="Direct link to heading">#</a></h2><p>A container should be deployable to a target machine simply by extracting an archive to a directory - the <code>BLENDED_HOME</code>. Within <code>BLENDED_HOME</code> all libraries are deployed within the <code>lib</code> sub directory, all configuration files shall be within the <code>etc</code> sub directory. If modules require storage on the file system, this storage should be beneath <code>BLENDED_HOME</code> as well.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>For example, some containers contain an embedded <a href="https://activemq.apache.org" target="_blank" rel="noopener noreferrer">ActiveMQ</a> broker, which requires a data directory.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="deployment-automation"></a>Deployment automation<a class="hash-link" href="#deployment-automation" title="Direct link to heading">#</a></h2><p>If containers of the same type are identical in terms of their libraries and configuration files and only differ within their environment variables, it is very easy to automate the deployment by different means:</p><ul><li><a href="https://www.docker.com/" target="_blank" rel="noopener noreferrer">Docker</a> images can be defined around the deployment archive and the environment variables are the configuration points to instantiate a docker container.</li><li>A <a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer">Kubernetes</a> deployment consisting of several <em>blended containers</em> - potentially of different types can be defined on top og the docker images simply by templating the injection of the environment variables.</li><li>Deployment to physical machines can be realized by tools such as <a href="https://www.ansible.com/" target="_blank" rel="noopener noreferrer">Ansible</a> simply by extracting the deployment archive to the target machine and then use a templating mechanism to create a script exposing the required environment variables.</li></ul><p>The creation of docker images can and should be automated within the build environment.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blended-zio/docs/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Blended Use Cases</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blended-zio/docs/core/index"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Blended ZIO Core Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#container-types" class="table-of-contents__link">Container types</a></li><li><a href="#container-deployment" class="table-of-contents__link">Container deployment</a></li><li><a href="#container-directory-structure" class="table-of-contents__link">Container directory structure</a></li><li><a href="#deployment-automation" class="table-of-contents__link">Deployment automation</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">About</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blended-zio/docs/andreas">Andreas Gies</a></li><li class="footer__item"><a class="footer__link-item" href="/blended-zio/docs/legal">Legal</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/jaHWkWqn" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://github.com/blended-zio/blended-zio/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussions</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blended-zio/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/blended-zio/blended-zio" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Way of Quality GmbH - Built with <a href="https://v2.docusaurus.io/">Docusaurus v2</a></div></div></div></footer></div>
<script src="/blended-zio/styles.da6d526b.js"></script>
<script src="/blended-zio/runtime~main.bbb75a21.js"></script>
<script src="/blended-zio/main.2b8b45e6.js"></script>
<script src="/blended-zio/1.9a06b93b.js"></script>
<script src="/blended-zio/2.a102c19c.js"></script>
<script src="/blended-zio/54.dd637c66.js"></script>
<script src="/blended-zio/55.9221783b.js"></script>
<script src="/blended-zio/935f2afb.ed868d14.js"></script>
<script src="/blended-zio/17896441.58f5d11b.js"></script>
<script src="/blended-zio/3509527d.8a506882.js"></script>
</body>
</html>